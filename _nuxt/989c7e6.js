(window.webpackJsonp=window.webpackJsonp||[]).push([[119],{491:function(e,t,r){e.exports=r.p+"img/google-oauth.d74992d.svg"},564:function(e,t,r){"use strict";r.r(t);var o=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"buy-step-list"},[r("div",{staticClass:"buy-step-list-title"},[e._v("Step1 of 3")]),e._v(" "),r("div",{staticClass:"buy-step-list-line"},[r("div",{staticClass:"buy-step-list-line-step"}),e._v(" "),r("div",{staticClass:"buy-step-list-line-step active",staticStyle:{width:"35%"}})])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"google-oauth2-photo"},[t("img",{attrs:{src:r(491),alt:""}})])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"signup-line"},[r("div",{staticClass:"signup-line-item"}),e._v(" "),r("div",{staticClass:"signup-line-item or"},[e._v("or")]),e._v(" "),r("div",{staticClass:"signup-line-item"})])}],n=r(2),c=(r(28),r(62)),l=r(54),v=r.n(l),m={name:"signup",auth:!1,data:function(){return{client_id:"68620927616-r33oljjk6ehkuk2i5p947p04hog3ni7h.apps.googleusercontent.com",client_secret:"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",callback_url:"",email:"",privacy:!1}},mounted:function(){var code=this.$route.query.code;this.callback_url=window.location.origin+"/signup",void 0!==code?this.googleLogin(code):this.email=this.$auth.$storage.getLocalStorage("email")},methods:{register:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e,/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(e.email)){t.next=5;break}return r.$message({showClose:!1,message:"malformed email",offset:200,type:"error"}),t.abrupt("return",!1);case 5:if(!1!==r.privacy){t.next=8;break}return r.$message({showClose:!1,message:"Must agree to privacy agreement",offset:200,type:"error"}),t.abrupt("return",!1);case 8:return r.$auth.$storage.setLocalStorage("email",e.email),t.abrupt("return",r.$router.push({path:"/pricing"}));case 10:case"end":return t.stop()}}),t)})))()},login:function(){!0===this.privacy?window.location.href="https://accounts.google.com/o/oauth2/v2/auth/oauthchooseaccount?access_type=offline&scope="+encodeURIComponent("https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile openid")+"&include_granted_scopes=true&response_type=code&client_id=68620927616-r33oljjk6ehkuk2i5p947p04hog3ni7h.apps.googleusercontent.com&redirect_uri="+encodeURIComponent(this.callback_url)+"&flowName=GeneralOAuthFlow":this.$message({showClose:!1,message:"Must agree to privacy agreement",offset:200,type:"error"})},googleLogin:function(code){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,o,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e,t.prev=1,t.next=4,Object(c.c)("https://www.googleapis.com/oauth2/v4/token?client_id="+r.client_id+"&client_secret="+r.client_secret+"&code="+code+"&grant_type=authorization_code&redirect_uri="+encodeURIComponent(r.callback_url));case 4:if(void 0===(o=t.sent).access_token){t.next=19;break}return t.next=8,Object(c.b)("https://admin.spyx.com/api/auth/google/callback",v.a.stringify({access_token:o.access_token}));case 8:if(void 0===(n=t.sent).jwt){t.next=18;break}return r.$auth.$storage.setLocalStorage("access-token",n.jwt),r.$auth.$storage.setLocalStorage("email",n.user.email),r.$auth.$storage.setLocalStorage("uid",n.user.id),r.$auth.$storage.setLocalStorage("user",n.user),r.$auth.setUser(n.user),t.abrupt("return",r.$router.push({path:"/pricing"}));case 18:r.$message({showClose:!1,message:"Authorization exception",offset:200,type:"error"});case 19:t.next=24;break;case 21:t.prev=21,t.t0=t.catch(1),r.$message({showClose:!1,message:"request exception",offset:200,type:"error"});case 24:case"end":return t.stop()}}),t,null,[[1,21]])})))()}}},h=r(3),component=Object(h.a)(m,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"signup"},[r("div",{staticClass:"container-large"},[r("div",{staticClass:"signup-box"},[e._m(0),e._v(" "),r("h2",[e._v("Create accout")]),e._v(" "),r("h6",[e._v("Once you are up,just log in from any device and see what they are up to .")]),e._v(" "),r("div",{staticClass:"google-oauth2",on:{click:e.login}},[e._m(1),e._v(" "),r("div",{staticClass:"google-oauth2-text"},[e._v("Continue with Goolge")])]),e._v(" "),e._m(2),e._v(" "),r("div",{staticClass:"form-item-input"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],attrs:{type:"email",placeholder:"Enter your valid email"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}})]),e._v(" "),r("p",{staticClass:"form-item-options"},[r("label",[r("input",{directives:[{name:"model",rawName:"v-model",value:e.privacy,expression:"privacy"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.privacy)?e._i(e.privacy,null)>-1:e.privacy},on:{change:function(t){var r=e.privacy,o=t.target,n=!!o.checked;if(Array.isArray(r)){var c=e._i(r,null);o.checked?c<0&&(e.privacy=r.concat([null])):c>-1&&(e.privacy=r.slice(0,c).concat(r.slice(c+1)))}else e.privacy=n}}}),e._v(" By clicking“Continue”, you are\n        accepting our ")]),e._v(" "),r("nuxt-link",{attrs:{to:{name:"privacy"}}},[e._v("Terms of Use")]),e._v("\n        and\n        "),r("nuxt-link",{attrs:{to:{name:"privacy"}}},[e._v("Privacy Policy")])],1),e._v(" "),r("div",{staticClass:"form-item"},[r("button",{staticClass:"button-signup-btn",on:{click:e.register}},[e._v("continue")])])])])])}),o,!1,null,"aa982732",null);t.default=component.exports}}]);